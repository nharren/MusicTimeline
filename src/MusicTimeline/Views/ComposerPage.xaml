<Page x:Class="NathanHarrenstein.MusicTimeline.Views.ComposerPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:c="clr-namespace:NathanHarrenstein.MusicTimeline.Controls"
      xmlns:cv="clr-namespace:NathanHarrenstein.MusicTimeline.Converters"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:db="clr-namespace:NathanHarrenstein.MusicTimeline.Data"
      xmlns:generic="clr-namespace:NathanHarrenstein.MusicTimeline.Generic"
      xmlns:l="clr-namespace:NathanHarrenstein.MusicTimeline"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      xmlns:v="clr-namespace:NathanHarrenstein.MusicTimeline.Views"
      Title="ComposerPage"
      d:DesignHeight="600"
      d:DesignWidth="800"
      Background="#EEEADD"
      FontFamily="Segoe UI"
      Foreground="#FEFEFE"
      mc:Ignorable="d">
    <Page.Resources>
        <cv:ComposerToBitmapImageConverter x:Key="ComposerToBitmapImageConverter" />
        <cv:UrlToCommandConverter x:Key="UrlToCommandConverter" />
        <cv:UrlToFaviconConverter x:Key="UrlToFaviconConverter" />
        <cv:CompositionsToSortedCompositionsConverter x:Key="CompositionsToSortedCompositionsConverter" />
        <cv:CompositionToCompositionDisplayNameConverter x:Key="CompositionToCompositionDisplayNameConverter" />
        <cv:YouTubeToThumbConverter x:Key="YouTubeToThumbConverter" />
        <cv:YouTubeToEmbedConverter x:Key="YouTubeToEmbedConverter" />
        <cv:SpotifyToEmbedConverter x:Key="SpotifyToEmbedConverter" />
    </Page.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition />
        </Grid.RowDefinitions>
        <ProgressBar Name="ProgressBar"
                     Height="6"
                     IsIndeterminate="True" />

        <!--#region Header-->
        <Border Grid.Row="1" BorderThickness="0">
            <Grid Background="#282828">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition />
                    <ColumnDefinition Width="500" />
                </Grid.ColumnDefinitions>
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                    <Button Height="60"
                            Margin="30,30,0,30"
                            HorizontalAlignment="Left"
                            VerticalAlignment="Center"
                            Click="backButton_Click"
                            Cursor="Hand">
                        <Button.Template>
                            <ControlTemplate TargetType="{x:Type Button}">
                                <Grid Margin="0,5" Background="Transparent">
                                    <ContentPresenter />
                                </Grid>
                            </ControlTemplate>
                        </Button.Template>
                        <Viewbox Stretch="Uniform">
                            <Path Fill="White">
                                <Path.Data>
                                    <PathGeometry Figures="m 0.96191406 5.5565993 q 0 0.6299 0.16601564 1.2158 0.1660156 0.5811 0.4638672 1.0938 0.2978515 0.5127 0.7128906 0.9326 0.4199219 0.4151 0.9277344 0.7129 0.5126953 0.2979 1.0986328 0.4639 0.5859375 0.1659997 1.2158203 0.1659997 0.6298828 0 1.2109375 -0.1659997 0.5859375 -0.166 1.0986328 -0.4688 0.5126953 -0.2978 0.9326172 -0.7129 0.4199219 -0.4199 0.7177734 -0.9277 0.3027344 -0.5127 0.46875 -1.0938 0.1660161 -0.5859 0.1660161 -1.2158 0 -0.6299 -0.1708989 -1.2109 -0.1660156 -0.586 -0.46875 -1.0986 -0.2978515 -0.5127 -0.7226562 -0.9327 -0.4199219 -0.4199 -0.9277344 -0.7177 -0.5078125 -0.3028 -1.09375 -0.4688 Q 6.1767578 0.96189932 5.546875 0.96189932 q -0.6298828 0 -1.2158203 0.16599998 -0.5859375 0.166 -1.0986328 0.4688 -0.5078125 0.2978 -0.9277344 0.7177 -0.4150391 0.42 -0.7128906 0.9327 -0.2978516 0.5126 -0.4638672 1.0986 -0.16601564 0.581 -0.16601564 1.2109 z m 3.77441404 -2.3584 1.6210938 0 -1.7041016 1.7432 3.7060547 0 0 1.2109 -3.7060547 0 1.7041016 1.7432 -1.6210938 0 L 2.5 5.5565993 l 0 -0.02 2.2363281 -2.3389 z M 0 5.5614993 q 0 -0.7617 0.20019531 -1.4697 0.20019532 -0.708 0.56640625 -1.3233 0.36621094 -0.6201 0.87402344 -1.1279 0.5078125 -0.5127 1.1230469 -0.87399998 0.6201172 -0.3662 1.3232422 -0.5664 Q 4.7949219 -6.807907e-7 5.5517578 -6.807907e-7 q 0.7568359 0 1.4599609 0.2051000007907 0.7080079 0.2002 1.3232422 0.5664 0.6201172 0.36619998 1.1279297 0.87889998 0.5126953 0.5078 0.8789064 1.1279 0.366211 0.6152 0.566406 1.3232 0.200195 0.7032 0.200195 1.46 0 0.7617 -0.200195 1.4697 -0.200195 0.7032 -0.566406 1.3233 -0.3662111 0.6152 -0.8789064 1.123 -0.5078125 0.5078 -1.1279297 0.8691997 -0.6152343 0.3613 -1.3232422 0.5615 -0.703125 0.2002 -1.4599609 0.2002 -0.7568359 0 -1.4648437 -0.2002 -0.703125 -0.2002 -1.3232422 -0.5664 Q 2.1484375 9.9755993 1.640625 9.4677993 1.1328125 8.9598993 0.76660156 8.3446993 0.40039063 7.7245993 0.20019531 7.0214993 0 6.3182993 0 5.5614993 Z" FillRule="NonZero" />
                                </Path.Data>
                            </Path>
                        </Viewbox>
                    </Button>
                    <TextBlock Name="ComposerNameTextBlock"
                               Grid.Column="1"
                               Margin="25,-1,0,0"
                               HorizontalAlignment="Left"
                               VerticalAlignment="Center"
                               FontFamily="Segoe UI Light"
                               FontSize="34pt"
                               Foreground="White" />
                    <c:NationalitiesPanel x:Name="nationalitiesPanel"
                                          Grid.Column="2"
                                          Height="120"
                                          Margin="0,8,0,0"
                                          FlagSeparation="20"
                                          MouseEnter="nationalitiesPanel_MouseEnter"
                                          MouseLeave="nationalitiesPanel_MouseLeave"
                                          UseLargeFlags="True" />
                    <c:NationalitiesEditPanel x:Name="nationalitiesEditPanel"
                                              Grid.Column="2"
                                              Width="300"
                                              Height="500"
                                              Margin="20,8,0,0"
                                              Cancelling="nationalitiesEditPanel_Cancelling"
                                              Saving="nationalitiesEditPanel_Saving"
                                              Visibility="Collapsed" />
                </Grid>
                <c:Mp3PlayerControl x:Name="mp3PlayerControl"
                                    Grid.Column="2"
                                    Height="120"
                                    MouseEnter="mp3PlayerControl_MouseEnter"
                                    MouseLeave="mp3PlayerControl_MouseLeave" />
                <c:SamplesEditPanel x:Name="samplesEditPanel"
                                    Grid.Column="2"
                                    Cancelling="samplesEditPanel_Cancelling"
                                    Saving="samplesEditPanel_Saving"
                                    Visibility="Collapsed" />
            </Grid>
        </Border>
        <!--#endregion-->

        <ScrollViewer Grid.Row="2"
                      PanningMode="VerticalOnly"
                      VerticalScrollBarVisibility="Auto">
            <Grid SnapsToDevicePixels="True"
                        UseLayoutRounding="True">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="2*" />
                    <ColumnDefinition Width="3*" />
                    <ColumnDefinition Width="2*" />
                </Grid.ColumnDefinitions>

                <!--#region Left Column-->
                <Border Background="{StaticResource DarkBackgroundBrush}" BorderThickness="0">
                    <StackPanel Grid.Column="0" Margin="30">

                        <!--  Images  -->
                        <!--<c:AddSaveToolbar x:Name="imagesToolbar"
                                          Height="31"
                                          Adding="imagesToolbar_Adding"
                                          Background="#33555555"
                                          BorderBrush="Black"
                                          BorderThickness="0"
                                          Cancelling="imagesToolbar_Cancelling"
                                          Removing="imagesToolbar_Removing"
                                          Saving="imagesToolbar_Saving"
                                          Visibility="Collapsed" />-->
                        <c:ImagesPanel x:Name="imagesPanel"
                                 HorizontalAlignment="Center"
                                 VerticalAlignment="Top" />

                        <!--  Details  -->
                        <StackPanel Margin="15,0,0,0" HorizontalAlignment="Left">
                            <!--  Born  -->
                            <c:EditableHeaderPanel x:Name="bornHeader"
                                                   Margin="0,15,0,6"
                                                   ButtonClick="bornHeader_ButtonClick"
                                                   ButtonForeground="{StaticResource HeaderBrush}"
                                                   ButtonSize="14.0"
                                                   FontFamily="Segoe UI Light"
                                                   FontSize="18.667"
                                                   Foreground="{StaticResource HeaderBrush}"
                                                   Text="Born"
                                                   UnderlineForeground="{StaticResource UnderlineBrush}" />
                            <StackPanel x:Name="bornEditPanel" Visibility="Collapsed">
                                <c:SaveToolbar x:Name="bornToolbar"
                                               Height="31"
                                               Background="#33555555"
                                               BorderBrush="Black"
                                               BorderThickness="0"
                                               Cancelling="bornToolbar_Cancelling"
                                               DockPanel.Dock="Top"
                                               Saving="bornToolbar_Saving" />
                                <TextBox Name="birthDateTextBox"
                                         Background="#33000000"
                                         BorderThickness="0"
                                         FontSize="11.5pt"
                                         Foreground="{StaticResource ForegroundBrush}"
                                         Padding="8,8,8,0" />
                                <TextBox Name="birthLocationTextBox"
                                         Background="#33000000"
                                         BorderThickness="0"
                                         FontSize="11.5pt"
                                         Foreground="{StaticResource ForegroundBrush}"
                                         Padding="8" />
                            </StackPanel>
                            <TextBlock Name="bornTextBlock"
                                       FontSize="11.5pt"
                                       Foreground="{StaticResource ForegroundBrush}" />

                            <!--  Died  -->
                            <c:EditableHeaderPanel x:Name="diedHeader"
                                                   Margin="0,15,0,6"
                                                   ButtonClick="diedHeader_ButtonClick"
                                                   ButtonForeground="{StaticResource HeaderBrush}"
                                                   ButtonSize="14.0"
                                                   FontFamily="Segoe UI Light"
                                                   FontSize="18.667"
                                                   Foreground="{StaticResource HeaderBrush}"
                                                   Text="Died"
                                                   UnderlineForeground="{StaticResource UnderlineBrush}" />
                            <StackPanel x:Name="diedEditPanel" Visibility="Collapsed">
                                <c:SaveToolbar x:Name="diedToolbar"
                                               Height="31"
                                               Background="#33555555"
                                               BorderBrush="Black"
                                               BorderThickness="0"
                                               Cancelling="diedToolbar_Cancelling"
                                               DockPanel.Dock="Top"
                                               Saving="diedToolbar_Saving" />
                                <TextBox Name="deathDateTextBox"
                                         Background="#33000000"
                                         BorderThickness="0"
                                         FontSize="11.5pt"
                                         Foreground="{StaticResource ForegroundBrush}"
                                         Padding="8,8,8,0" />
                                <TextBox Name="deathLocationTextBox"
                                         Background="#33000000"
                                         BorderThickness="0"
                                         FontSize="11.5pt"
                                         Foreground="{StaticResource ForegroundBrush}"
                                         Padding="8" />
                            </StackPanel>
                            <TextBlock Name="diedTextBlock"
                                       FontSize="11.5pt"
                                       Foreground="{StaticResource ForegroundBrush}" />

                            <!--  Influences  -->
                            <c:EditableHeaderPanel x:Name="influencesHeader"
                                                   Margin="0,15,0,6"
                                                   ButtonClick="influencesHeader_ButtonClick"
                                                   ButtonForeground="{StaticResource HeaderBrush}"
                                                   ButtonSize="14.0"
                                                   FontFamily="Segoe UI Light"
                                                   FontSize="18.667"
                                                   Foreground="{StaticResource HeaderBrush}"
                                                   Text="Influences"
                                                   UnderlineForeground="{StaticResource UnderlineBrush}" />
                            <StackPanel x:Name="influencesEditPanel" Visibility="Collapsed">
                                <c:SaveToolbar x:Name="influencesToolbar"
                                               Height="31"
                                               Background="#33555555"
                                               BorderBrush="Black"
                                               BorderThickness="0"
                                               Cancelling="influencesToolbar_Cancelling"
                                               DockPanel.Dock="Top"
                                               Saving="influencesToolbar_Saving" />
                                <ListBox Name="influencesListBox"
                                         Background="#33000000"
                                         BorderThickness="0"
                                         Padding="5"
                                         SelectionMode="Multiple">
                                    <ListBox.ItemTemplate>
                                        <DataTemplate DataType="{x:Type db:Composer}">
                                            <TextBlock FontSize="17.333333333333332"
                                                       Foreground="{StaticResource ForegroundBrush}"
                                                       Text="{Binding Name}" />
                                        </DataTemplate>
                                    </ListBox.ItemTemplate>
                                </ListBox>
                            </StackPanel>
                            <ItemsControl Name="influencesItemsControl">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate DataType="{x:Type db:Composer}">
                                        <Button Name="influenceButton"
                                                Margin="0,0,0,5"
                                                Click="influenceButton_Click"
                                                Content="{Binding Name}"
                                                Cursor="Hand"
                                                FontSize="11.5pt"
                                                Foreground="{StaticResource ForegroundBrush}">
                                            <Button.Template>
                                                <ControlTemplate TargetType="{x:Type Button}">
                                                    <Grid>
                                                        <ContentPresenter />
                                                    </Grid>
                                                </ControlTemplate>
                                            </Button.Template>
                                        </Button>
                                        <DataTemplate.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter TargetName="influenceButton" Property="Foreground" Value="White" />
                                            </Trigger>
                                        </DataTemplate.Triggers>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>

                            <!--  Influenced  -->
                            <c:EditableHeaderPanel x:Name="influencedHeader"
                                                   Margin="0,15,0,5"
                                                   ButtonClick="influencedHeader_ButtonClick"
                                                   ButtonForeground="{StaticResource HeaderBrush}"
                                                   ButtonSize="14.0"
                                                   FontFamily="Segoe UI Light"
                                                   FontSize="18.667"
                                                   Foreground="{StaticResource HeaderBrush}"
                                                   Text="Influenced"
                                                   UnderlineForeground="{StaticResource UnderlineBrush}" />
                            <StackPanel x:Name="influencedEditPanel" Visibility="Collapsed">
                                <c:SaveToolbar x:Name="influencedToolbar"
                                               Height="31"
                                               Background="#33555555"
                                               BorderBrush="Black"
                                               BorderThickness="0"
                                               Cancelling="influencedToolbar_Cancelling"
                                               DockPanel.Dock="Top"
                                               Saving="influencedToolbar_Saving" />
                                <ListBox Name="influencedListBox"
                                         Background="#33000000"
                                         BorderThickness="0"
                                         Padding="5"
                                         SelectionMode="Multiple">
                                    <ListBox.ItemTemplate>
                                        <DataTemplate DataType="{x:Type db:Composer}">
                                            <TextBlock FontSize="11.5pt"
                                                       Foreground="{StaticResource ForegroundBrush}"
                                                       Text="{Binding Name}" />
                                        </DataTemplate>
                                    </ListBox.ItemTemplate>
                                </ListBox>
                            </StackPanel>
                            <ItemsControl Name="influencedItemsControl">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate DataType="{x:Type db:Composer}">
                                        <Button Name="influencedButton"
                                                Margin="0,0,0,5"
                                                Click="influenceButton_Click"
                                                Content="{Binding Name}"
                                                Cursor="Hand"
                                                FontSize="11.5pt"
                                                Foreground="{StaticResource ForegroundBrush}">
                                            <Button.Template>
                                                <ControlTemplate TargetType="{x:Type Button}">
                                                    <Grid>
                                                        <ContentPresenter />
                                                    </Grid>
                                                </ControlTemplate>
                                            </Button.Template>
                                        </Button>
                                        <DataTemplate.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter TargetName="influencedButton" Property="Foreground" Value="White" />
                                            </Trigger>
                                        </DataTemplate.Triggers>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>

                            <!--  Media  -->
                            <c:EditableHeaderPanel x:Name="mediaHeader"
                                                   Margin="0,15,0,5"
                                                   ButtonClick="mediaHeader_ButtonClick"
                                                   ButtonForeground="{StaticResource HeaderBrush}"
                                                   ButtonSize="14.0"
                                                   FontFamily="Segoe UI Light"
                                                   FontSize="18.667"
                                                   Foreground="{StaticResource HeaderBrush}"
                                                   Text="Media"
                                                   UnderlineForeground="{StaticResource UnderlineBrush}" />
                            <StackPanel x:Name="mediaEditPanel" Visibility="Collapsed">
                                <c:AddSaveToolbar x:Name="mediaToolbar"
                                                  Height="31"
                                                  Adding="mediaToolbar_Adding"
                                                  Background="#33555555"
                                                  BorderBrush="Black"
                                                  BorderThickness="0"
                                                  Cancelling="mediaToolbar_Cancelling"
                                                  DockPanel.Dock="Top"
                                                  Removing="mediaToolbar_Removing"
                                                  Saving="mediaToolbar_Saving" />
                                <ListBox Name="mediaListBox"
                                         Background="#33000000"
                                         BorderThickness="0"
                                         Padding="5"
                                         SelectionChanged="mediaListBox_SelectionChanged">
                                    <ListBox.ItemContainerStyle>
                                        <Style TargetType="ListBoxItem">
                                            <Setter Property="IsSelected" Value="{Binding Content.IsSelected, Mode=TwoWay, RelativeSource={RelativeSource Self}}" />
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="ListBoxItem">
                                                        <ContentPresenter />
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                        </Style>
                                    </ListBox.ItemContainerStyle>
                                    <ListBox.ItemTemplateSelector>
                                        <c:SelectionDataTemplateSelector>
                                            <c:SelectionDataTemplateSelector.SelectedTemplate>
                                                <DataTemplate DataType="{x:Type db:Link}">
                                                    <TextBox Name="mediaTextBox"
                                                             Background="#33000000"
                                                             BorderThickness="0"
                                                             FontSize="11.5pt"
                                                             Foreground="{StaticResource ForegroundBrush}"
                                                             LostFocus="linkTextBox_LostFocus"
                                                             Padding="8"
                                                             Text="{Binding Url}" />
                                                </DataTemplate>
                                            </c:SelectionDataTemplateSelector.SelectedTemplate>
                                            <c:SelectionDataTemplateSelector.UnselectedTemplate>
                                                <DataTemplate DataType="{x:Type db:Link}">
                                                    <TextBlock Margin="0,0,0,5"
                                                               FontSize="11.5pt"
                                                               Foreground="{StaticResource ForegroundBrush}"
                                                               Text="{Binding Name}" />
                                                </DataTemplate>
                                            </c:SelectionDataTemplateSelector.UnselectedTemplate>
                                        </c:SelectionDataTemplateSelector>
                                    </ListBox.ItemTemplateSelector>
                                </ListBox>
                            </StackPanel>
                            <ItemsControl Name="mediaItemsControl"
                                          MinWidth="16"
                                          MinHeight="16">
                                <ItemsControl.ItemTemplateSelector>
                                    <c:MediaDataTemplateSelector>
                                        <c:MediaDataTemplateSelector.YouTubeTemplate>
                                            <DataTemplate DataType="{x:Type db:Link}">
                                                <Button Name="youTubeButton"
                                                        Margin="0,0,0,15"
                                                        HorizontalContentAlignment="Stretch"
                                                        Click="youTubeButton_Click"
                                                        Cursor="Hand"
                                                        Template="{StaticResource ChromelessButtonTemplate}">
                                                    <Grid>
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="Auto" />
                                                            <ColumnDefinition />
                                                        </Grid.ColumnDefinitions>
                                                        <Image Width="120"
                                                               Height="75"
                                                               Source="{Binding Url,
                                                                                Converter={StaticResource YouTubeToThumbConverter}}" />
                                                        <TextBlock x:Name="youTubeCaption"
                                                                   Grid.Column="2"
                                                                   Margin="8,0,0,0"
                                                                   HorizontalAlignment="Left"
                                                                   VerticalAlignment="Center"
                                                                   FontSize="11.5pt"
                                                                   Foreground="{StaticResource ForegroundBrush}"
                                                                   Text="{Binding Name}"
                                                                   TextWrapping="Wrap" />
                                                    </Grid>
                                                </Button>
                                                <DataTemplate.Triggers>
                                                    <Trigger Property="IsMouseOver" Value="True">
                                                        <Setter TargetName="youTubeCaption" Property="Foreground" Value="White" />
                                                    </Trigger>
                                                </DataTemplate.Triggers>
                                            </DataTemplate>
                                        </c:MediaDataTemplateSelector.YouTubeTemplate>
                                    </c:MediaDataTemplateSelector>
                                </ItemsControl.ItemTemplateSelector>
                            </ItemsControl>

                            <!--  Links  -->
                            <c:EditableHeaderPanel x:Name="linksHeader"
                                                   Margin="0,15,0,5"
                                                   ButtonClick="linksHeader_ButtonClick"
                                                   ButtonForeground="{StaticResource HeaderBrush}"
                                                   ButtonSize="14.0"
                                                   FontFamily="Segoe UI Light"
                                                   FontSize="18.667"
                                                   Foreground="{StaticResource HeaderBrush}"
                                                   Text="Links"
                                                   UnderlineForeground="{StaticResource UnderlineBrush}" />
                            <StackPanel x:Name="linksEditPanel" Visibility="Collapsed">
                                <c:AddSaveToolbar x:Name="linksToolbar"
                                                  Height="31"
                                                  Adding="linksToolbar_Adding"
                                                  Background="#33555555"
                                                  BorderBrush="Black"
                                                  BorderThickness="0"
                                                  Cancelling="linksToolbar_Cancelling"
                                                  DockPanel.Dock="Top"
                                                  Removing="linksToolbar_Removing"
                                                  Saving="linksToolbar_Saving" />
                                <ListBox Name="linksListBox"
                                         Background="#33000000"
                                         BorderThickness="0"
                                         Padding="5"
                                         SelectionChanged="linksListBox_SelectionChanged">
                                    <ListBox.ItemContainerStyle>
                                        <Style TargetType="ListBoxItem">
                                            <Setter Property="IsSelected" Value="{Binding Content.IsSelected, Mode=TwoWay, RelativeSource={RelativeSource Self}}" />
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="ListBoxItem">
                                                        <ContentPresenter />
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                        </Style>
                                    </ListBox.ItemContainerStyle>
                                    <ListBox.ItemTemplateSelector>
                                        <c:SelectionDataTemplateSelector>
                                            <c:SelectionDataTemplateSelector.SelectedTemplate>
                                                <DataTemplate DataType="{x:Type db:Link}">
                                                    <TextBox Name="linkTextBox"
                                                             Background="#33000000"
                                                             BorderThickness="0"
                                                             FontSize="11.5pt"
                                                             Foreground="{StaticResource ForegroundBrush}"
                                                             LostFocus="linkTextBox_LostFocus"
                                                             Padding="8"
                                                             Text="{Binding Url}" />
                                                </DataTemplate>
                                            </c:SelectionDataTemplateSelector.SelectedTemplate>
                                            <c:SelectionDataTemplateSelector.UnselectedTemplate>
                                                <DataTemplate DataType="{x:Type db:Link}">
                                                    <TextBlock Margin="0,0,0,5"
                                                               FontSize="11.5pt"
                                                               Foreground="{StaticResource ForegroundBrush}"
                                                               Text="{Binding Name}" />
                                                </DataTemplate>
                                            </c:SelectionDataTemplateSelector.UnselectedTemplate>
                                        </c:SelectionDataTemplateSelector>
                                    </ListBox.ItemTemplateSelector>
                                </ListBox>
                            </StackPanel>
                            <ItemsControl Name="linksItemsControl"
                                          MinWidth="16"
                                          MinHeight="16">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate DataType="{x:Type db:Link}">
                                        <Button Name="linkButton"
                                                Margin="0,0,0,5"
                                                Command="{Binding Url,
                                                                  Converter={StaticResource UrlToCommandConverter},
                                                                  Mode=OneWay,
                                                                  IsAsync=True}"
                                                Cursor="Hand">
                                            <Button.Template>
                                                <ControlTemplate>
                                                    <StackPanel Orientation="Horizontal">
                                                        <Image Width="16"
                                                               Height="16"
                                                               Margin="0,0,10,0"
                                                               SnapsToDevicePixels="True"
                                                               Source="{Binding Url,
                                                                                Converter={StaticResource UrlToFaviconConverter},
                                                                                Mode=OneWay,
                                                                                IsAsync=True}" />
                                                        <TextBlock Name="linkTextBlock"
                                                                   FontSize="11.5pt"
                                                                   Foreground="{StaticResource ForegroundBrush}"
                                                                   Text="{Binding Name}" />
                                                    </StackPanel>
                                                    <ControlTemplate.Triggers>
                                                        <Trigger Property="IsMouseOver" Value="True">
                                                            <Setter TargetName="linkTextBlock" Property="Foreground" Value="White" />
                                                        </Trigger>
                                                    </ControlTemplate.Triggers>
                                                </ControlTemplate>
                                            </Button.Template>
                                        </Button>
                                        <DataTemplate.Triggers />
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </StackPanel>
                    </StackPanel>
                </Border>
                <!--#endregion-->

                <!--#region Middle Column-->
                <Border Grid.Column="1"
                        Background="{StaticResource LightBackgroundBrush}"
                        BorderThickness="0"
                        >
                    <Grid Grid.Column="1" Margin="30">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>
                        <c:EditableHeaderPanel x:Name="biographyHeader"
                                               ButtonClick="biographyHeader_ButtonClick"
                                               ButtonForeground="Black"
                                               ButtonMargin="0,10,0,0"
                                               ButtonSize="14"
                                               FontFamily="Segoe UI Light"
                                               FontSize="24"
                                               Foreground="#FEFEFE"
                                               Text="Biography"
                                               UnderlineForeground="#11000000"
                                               UnderlineOffset="4" />
                        <Border BorderThickness="1" x:Name="biographyEditPanel" Visibility="Collapsed" BorderBrush="{StaticResource InputBorderBrush}" Grid.Row="1"
                                   Margin="0,10,0,0" >
                            
                        
                        <DockPanel 
                                   LastChildFill="True"
                                   >
                            <c:BiographyToolbar x:Name="biographyToolbar"
                                                Height="31"
                                                Background="{StaticResource MenuBackgroundBrush}"
                                                Foreground="{StaticResource MenuForegroundBrush}"
                                                BorderThickness="0,0,0,1"
                                                BorderBrush="{StaticResource InputBorderBrush}"
                                                Cancelling="biographyToolbar_Cancelling"
                                                DockPanel.Dock="Top"
                                                RichTextBox="{Binding ElementName=biographyRichTextBox}"
                                                Saving="biographyToolbar_Saving" />
                            <RichTextBox x:Name="biographyRichTextBox"
                                         AcceptsReturn="True"
                                         AcceptsTab="True"
                                         Background="{StaticResource InputBackgroundBrush}"
                                         BorderThickness="0"
                                         Padding="10"
                                         HorizontalScrollBarVisibility="Disabled"
                                         IsInactiveSelectionHighlightEnabled="True"
                                         RequestBringIntoView="biographyTextBox_RequestBringIntoView"
                                         VerticalScrollBarVisibility="Disabled">
                                <RichTextBox.Template>
                                    <ControlTemplate TargetType="{x:Type TextBoxBase}">
                                        <Border x:Name="border"
                                                Background="{TemplateBinding Background}"
                                                BorderBrush="{TemplateBinding BorderBrush}"
                                                BorderThickness="{TemplateBinding BorderThickness}"
                                                SnapsToDevicePixels="True">
                                            <ScrollViewer x:Name="PART_ContentHost"
                                                          Focusable="False"
                                                          HorizontalScrollBarVisibility="Hidden"
                                                          VerticalScrollBarVisibility="Hidden" />
                                        </Border>
                                    </ControlTemplate>
                                </RichTextBox.Template>
                            </RichTextBox>
                        </DockPanel>
                            </Border>
                        <c:NonBlockingFlowDocumentScrollViewer x:Name="biographyScrollViewer"
                                                               Grid.Row="1"
                                                               Grid.ColumnSpan="2"
                                                               Margin="0,10,0,0"
                                                               HorizontalScrollBarVisibility="Disabled"
                                                               VerticalScrollBarVisibility="Disabled" />
                    </Grid>
                </Border>
                <!--#endregion-->

                <!--#region Right Column-->
                <Border Grid.Column="2"
                        Background="Black"
                        BorderThickness="0">
                    <Grid Margin="30">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>
                        <c:EditableHeaderPanel x:Name="compositionsHeader"
                                               ButtonClick="compositionsHeader_ButtonClick"
                                               ButtonForeground="Black"
                                               ButtonMargin="0,10,0,0"
                                               ButtonSize="14"
                                               FontFamily="Segoe UI Light"
                                               FontSize="24"
                                               Foreground="#FEFEFE"
                                               Text="Compositions"
                                               UnderlineForeground="#11000000"
                                               UnderlineOffset="4" />
                        <c:CompositionsEditPanel x:Name="compositionsEditPanel"
                                                 Grid.Row="1"
                                                 Margin="0,10,0,0"
                                                 Cancelling="compositionsEditPanel_Cancelling"
                                                 Saving="compositionsEditPanel_Saving"
                                                 Visibility="Collapsed" />
                        <c:CompositionsPanel x:Name="compositionsPanel" Grid.Row="1">
                            <c:CompositionsPanel.CompositionItemStyle>
                                <Style TargetType="TextBox">
                                    <Setter Property="Background" Value="Black" />
                                    <Setter Property="Foreground" Value="White" />
                                    <Setter Property="BorderThickness" Value="0" />
                                    <Setter Property="FontSize" Value="11.5pt" />
                                </Style>
                            </c:CompositionsPanel.CompositionItemStyle>
                        </c:CompositionsPanel>
                    </Grid>
                </Border>
                <!--#endregion-->
            </Grid>
        </ScrollViewer>
    </Grid>
</Page>